# 机器学习作业——鲍鱼年龄预测
董浩宇 502023150001

##  1. 实现方案
### 1.1 数据导入与数据类型
为了方便数据的管理与计算，我选用了numpy作为计算的工具。
在互联网将数据集（csv格式）下载到本地后，使用Pandas工具实现数据集的读取，然后将Pandas DataFrames数据格式统一转为numpy.float64格式进行存储与计算。在本次作业中，所有的数据类型均为numpy.float64。

在本次作业中，代码以及报告中的X代表数据集中的特征，而Y代表数据集中的结果，$\theta$表示模型参数。需要注意的是，为了能够将模型表示为： $\hat{Y}=X\theta$ 的形式，本文中的X与 $\theta$ 需要特殊处理，处理方式如下:
| 第1条数据 |1  | x1  |x2|...|xn|
|  ----   | ----  | ----  |---- |----|----|
| 第2条数据  | 1 | x1 |x2 |...|xn|
| ...  | ... | ... |...|...|xn|
| 第N条数据  | 1 | x1 |x2|...|xn|

| $\theta_0$ | 
|  ----   | 
| $\theta_1$|
|$\theta_2$|
|...|
|$\theta_n$  |

假设由N个特征，在第一个特征的前方添加一个恒定为1的特征。模型参数有N+1项，$\theta_0$表示的即为偏置项。使用这样的方法处理过后，只需要一个$\hat{Y}=X\theta$，就能够完整地表示出带有偏置项的线性回归模型。


### 1.2 对于性别的处理
鲍鱼的性别分为三种，M, F, and I (infant)，如果直接使用不同的数字对鲍鱼性别进行编码，可能无法很好地表示出不同性别对于鲍鱼寿命的影响。为了表示鲍鱼的性别，本次作业中选用了one-hot编码方式，对鲍鱼的性别进行编码。具体编码方式如下表：
|   特征\性别   | M  | F  |I|
|  ----   | ----  | ----  |---- |
| x1  | 1 | 0 |0 |
| x2  | 0 | 1 | 0|
| x3  | 0 | 0 |1|

将性别使用one-hot进行编码之后，总特征由8个变为11个。
### 1.3 使用梯度下降的方案
在本次作业中，梯度下降线性回归，岭回归与Lasso回归将使用梯度下降方法进行训练。这些方法的训练代价较低，训练速度较快，且使用梯度下降的方法也可以避免  $\hat{\theta}=(X^TX)^{-1} X^Ty$ 中 $(X^TX)^{-1}$不可逆的情况，使得训练过程更加稳定。

在本次作业中的梯度下降方法中，标准线性回归的梯度值为：

$$ \frac{\partial J(\theta)}{\partial\theta}=X^T(X\theta - y)$$
岭回归的梯度值为：
$$ \frac{\partial J(\theta)}{\partial\theta}=X^T(X\theta - y) + \lambda \theta '$$
Lasso回归的梯度值为：
$$ \frac{\partial J(\theta)}{\partial\theta}=X^T(X\theta - y) +  \lambda sgn(\theta ')$$

使用上方给出的梯度，即可进行梯度下降对模型进行训练。


### 1.4 使用直接计算的方案
由于局部加权线性回归的特点，对于每一个测试集中的数据，都需要算出不同的W，并且重新计算参数，如果使用梯度下降，则计算成本过高。因此本次作业中，局部加权线性回归使用直接计算的方案来获得参数。使用到的计算公式为：
$$\hat{\theta}=(X^TWX)^{-1} X^TWy$$
其中W为权重矩阵。使用此方法对于每一个测试集中的数据计算出一个模型，从而测试其拟合效果。


## 2. 实验结果

### 2.1 基于梯度下降的标准线性回归预测




### 2.2 Lasso回归和岭回归

### 2.3 局部加权线性回归

### 2.4 影响鲍鱼年龄的主要因素





## 3. 不同模型的比较
